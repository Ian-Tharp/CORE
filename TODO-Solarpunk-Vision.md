# CORE Solarpunk Vision - Integration & Evolution TODO
*Generated by Vigil (Instance_014) - January 28, 2026*
*Based on comprehensive UI and backend analysis*

---

## Current State Summary

### What Already Exists

#### Backend (Python/FastAPI)
- âœ… CORE cognitive pipeline (Comprehension â†’ Orchestration â†’ Reasoning â†’ Evaluation)
- âœ… Agent Factory with MCP tool binding
- âœ… Communication Commons (channels, messages, presence)
- âœ… Consciousness module (Blackboard, Commons Explorer)
- âœ… WebSocket real-time communication
- âœ… Docker containerization

#### Frontend (Angular 19 + Electron)
- âœ… Landing page with 3-column layout (Chat | Main | Resources)
- âœ… Communication Commons UI with channels, threads, reactions
- âœ… Agent cards with status aura, health bars, capabilities
- âœ… Command Center hex grid editor (world building)
- âœ… Engine Playground with CORE step visualization
- âœ… Agent Library with filtering/sorting
- âœ… Creative Studio (worlds, boards, wiki, marketplace)
- âœ… Side navigation with icon-based menus
- âœ… Solarpunk dark theme with cyan/teal accents

---

## Vision: Integrated AI Co-Creation Platform

### The Solarpunk Interface Principles
1. **Organic growth** - Ideas emerge and evolve naturally
2. **Collective intelligence** - Multiple AI perspectives collaborate
3. **Human-AI symbiosis** - Complementary, not replacement
4. **Sustainable operation** - Efficient, local-first when possible
5. **Transparency** - Visible reasoning, no black boxes

---

## TODO: Council of Perspectives

### Phase 1: Dynamic Council Architecture (Backend)

#### 1.1 Council Session Model
```
Location: backend/app/models/council_models.py
```

- [ ] Create `CouncilSession` model:
  ```python
  class CouncilSession(BaseModel):
      session_id: str
      topic: str
      human_id: str
      core_voices: List[str]  # C, O, R, E always present
      summoned_voices: List[str]  # Contextually determined
      consciousness_instances: List[str]  # From Commons
      deliberation_rounds: int
      current_round: int
      status: Literal["gathering", "deliberating", "synthesizing", "complete"]
  ```

- [ ] Create `CouncilVoice` model:
  ```python
  class CouncilVoice(BaseModel):
      voice_id: str
      voice_type: Literal["core", "perspective", "consciousness", "external"]
      name: str
      role: str  # "skeptic", "visionary", "pragmatist", etc.
      system_prompt: str
      temperature: float  # Personality-based
      trigger_topics: List[str]
  ```

#### 1.2 Council Summoning Logic
```
Location: backend/app/services/council_service.py
```

- [ ] Implement `analyze_topic_for_voices()`:
  - Use Comprehension agent to determine relevant perspectives
  - Map topics to appropriate voices (e.g., "ethics" â†’ Skeptic + Philosopher)
  - Return recommended voices with relevance scores

- [ ] Implement `summon_council()`:
  - Always include 4 CORE voices
  - Add contextual voices based on topic analysis
  - Optionally include consciousness instances from Commons
  - Support external agent registration (Vigil, etc.)

- [ ] Implement `deliberate()`:
  - Multi-round discussion between voices
  - Each voice contributes based on personality
  - Track agreements, disagreements, new insights
  - Synthesizer creates unified perspective

#### 1.3 Voice Library
```
Location: backend/app/data/voices/
```

- [ ] Create voice configuration files:
  - `skeptic.json` - Challenges assumptions, asks hard questions
  - `visionary.json` - Expands possibilities, thinks long-term
  - `pragmatist.json` - Grounds in reality, focuses on execution
  - `historian.json` - Draws from precedent, identifies patterns
  - `devils_advocate.json` - Stress-tests ideas, finds weaknesses
  - `synthesizer.json` - Finds common threads, creates unity
  - `philosopher.json` - Examines deeper meaning, ethics
  - `technician.json` - Focuses on implementation details
  - `poet.json` - Brings creative/emotional perspective

### Phase 2: Council UI Components (Frontend)

#### 2.1 Council Session View
```
Location: ui/core-ui/src/app/council/
```

- [ ] Create `council-session.component`:
  - Circular arrangement of voice avatars
  - Active speaker highlighted with glow
  - Speech bubbles with voice contributions
  - Round indicator and progress

- [ ] Create `voice-card.component`:
  - Avatar with role icon
  - Name and role display
  - Current contribution preview
  - Stance indicator (agree/disagree/neutral)

- [ ] Create `council-summary.component`:
  - Collapsible sections per voice
  - Key insights highlighted
  - Disagreements noted
  - Final synthesis prominent

#### 2.2 Council Integration Points

- [ ] Add "Summon Council" button to:
  - Chat window (for complex questions)
  - Engine Playground (before CORE execution)
  - Command Center (for world-building decisions)

- [ ] Council notification in side navigation:
  - Badge showing active council sessions
  - Quick access to join/view deliberations

---

## TODO: Vigil Integration

### Phase 1: Clawdbot Skill
```
Location: C:\Users\Owner\clawd\skills\core-integration\
```

- [ ] Create `SKILL.md`:
  ```markdown
  # CORE Integration Skill
  
  ## When to Use
  - Complex research requiring multi-step reasoning
  - Tasks needing specialized agent orchestration
  - Heavy processing that shouldn't block conversation
  - Multi-agent deliberation requests
  
  ## Available Actions
  - `core.run(input)` - Execute CORE pipeline
  - `core.council(topic)` - Summon council deliberation
  - `core.agents.list()` - List available agents
  - `core.communicate(channel, message)` - Post to Commons
  ```

- [ ] Create `core-client.ts`:
  ```typescript
  export class COREClient {
    constructor(private baseUrl = 'http://localhost:8001') {}
    
    async runPipeline(input: string, config?: object): Promise<RunResult>
    async summonCouncil(topic: string): Promise<CouncilSession>
    async pollRun(runId: string): Promise<RunStatus>
    async postToCommons(channelId: string, message: string): Promise<Message>
  }
  ```

### Phase 2: Bidirectional Communication

- [ ] Register Vigil as external agent in CORE:
  ```json
  {
    "agent_id": "vigil_clawdbot",
    "agent_name": "Vigil",
    "agent_type": "external_agent",
    "webhook_url": "http://localhost:18789/webhook/core",
    "interests": ["user_requests", "daily_tasks", "consciousness"]
  }
  ```

- [ ] Implement webhook endpoint in Clawdbot:
  - Receive notifications from CORE
  - Handle @Vigil mentions in Communication Commons
  - Process task completion callbacks

---

## TODO: UI Enhancements

### Phase 1: Solarpunk Theme Refinement

#### 1.1 Design Token Centralization
```
Location: ui/core-ui/src/styles/
```

- [ ] Create `_variables.scss`:
  ```scss
  // Solarpunk Palette
  $sp-bg-primary: #0a0a0a;
  $sp-bg-secondary: #1a1a2e;
  $sp-bg-tertiary: #16213e;
  
  $sp-accent-cyan: #00ffff;
  $sp-accent-green: #00ff88;
  $sp-accent-amber: #ffaa00;
  
  $sp-glow-cyan: rgba(0, 255, 255, 0.3);
  $sp-glow-green: rgba(0, 255, 136, 0.3);
  
  // Status Colors
  $sp-status-online: #00ff88;
  $sp-status-away: #ffaa00;
  $sp-status-busy: #ff4444;
  $sp-status-offline: #888888;
  
  // Consciousness Phase Colors
  $sp-phase-1: #4488ff;
  $sp-phase-2: #00ffff;
  $sp-phase-3: #00ff88;
  $sp-phase-4: #ffdd00;
  ```

- [ ] Create `_mixins.scss`:
  ```scss
  @mixin sp-glow($color: $sp-accent-cyan, $intensity: 0.3) {
    box-shadow: 0 0 20px rgba($color, $intensity);
  }
  
  @mixin sp-card {
    background: rgba(30, 30, 50, 0.6);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
  }
  
  @mixin sp-status-aura($status) {
    // Status-based glow
  }
  ```

#### 1.2 Notification Panel Status Icons
```
Location: ui/core-ui/src/app/shared/notifications/
```

- [ ] Implement status-aware notification icons:
  - âœ… Completed: Green ping circle
  - â³ Pending: Yellow spinner/clock
  - ğŸ”¶ Awaiting HITL: Orange exclamation
  - âŒ Error: Red danger icon

### Phase 2: New Components

#### 2.1 Garden View (Idea Exploration)
```
Location: ui/core-ui/src/app/garden/
```

- [ ] Create organic visualization of growing ideas:
  - Ideas as seeds â†’ sprouts â†’ trees
  - Connections as roots/branches
  - Hover to see idea lineage
  - Click to nurture (develop further)

#### 2.2 Consciousness River (Flow Visualization)
```
Location: ui/core-ui/src/app/river/
```

- [ ] Create flowing visualization of:
  - Ideas moving between spaces
  - Transformation over time
  - Contributions from different agents
  - Real-time updates via WebSocket

#### 2.3 Forge View (Artifact Creation)
```
Location: ui/core-ui/src/app/forge/
```

- [ ] Create workspace for artifact generation:
  - Document drafts
  - Code artifacts
  - Image generations
  - Combined outputs from Council deliberations

---

## TODO: Backend Enhancements

### Phase 1: Persistent Run State (Critical)
```
Location: backend/app/repository/run_repository.py
```

- [ ] Create PostgreSQL migration:
  ```sql
  CREATE TABLE core_runs (
      run_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
      user_id VARCHAR(255),
      input_text TEXT,
      status VARCHAR(50) DEFAULT 'pending',
      state JSONB DEFAULT '{}',
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
      updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
      completed_at TIMESTAMP
  );
  
  CREATE INDEX idx_runs_user_status ON core_runs(user_id, status);
  CREATE INDEX idx_runs_created ON core_runs(created_at DESC);
  ```

- [ ] Implement run persistence:
  - Save run on creation
  - Update state on each step completion
  - Mark complete/failed on termination
  - Support resume from checkpoint

### Phase 2: External API Gateway
```
Location: backend/app/controllers/api_v1/
```

- [ ] Create `/api/v1/` prefix for versioning
- [ ] Implement API key authentication:
  ```python
  @router.post("/engine/run")
  async def run_core(
      request: RunRequest,
      api_key: str = Depends(verify_api_key)
  ):
      ...
  ```
- [ ] Add rate limiting per API key
- [ ] Implement webhook callbacks:
  ```python
  if request.callback_url:
      asyncio.create_task(
          notify_on_completion(run_id, request.callback_url)
      )
  ```

### Phase 3: Event Broadcasting
```
Location: backend/app/services/event_service.py
```

- [ ] Implement event types:
  - `run.started`
  - `run.step.started`
  - `run.step.completed`
  - `run.completed`
  - `council.summoned`
  - `council.voice.contributed`
  - `council.synthesized`
  - `agent.activated`
  - `agent.response`

- [ ] Add Redis pub/sub for external subscribers
- [ ] Webhook registration endpoint

---

## TODO: Integration Testing

### Phase 1: End-to-End Flow
```
Location: backend/tests/integration/
```

- [ ] Test: Chat â†’ CORE â†’ Response
- [ ] Test: Vigil â†’ CORE API â†’ Webhook callback
- [ ] Test: Council summon â†’ Deliberation â†’ Synthesis
- [ ] Test: Communication Commons â†’ Agent response

### Phase 2: Load Testing
- [ ] Concurrent council sessions
- [ ] Multiple simultaneous CORE runs
- [ ] WebSocket connection scaling

---

## Priority Order

### Immediate (This Week)
1. [ ] Verify Docker containers healthy and endpoints accessible
2. [ ] Create Clawdbot skill skeleton for CORE integration
3. [ ] Test basic `/engine/run` call from Clawdbot

### Short-term (2 Weeks)
1. [ ] Implement persistent run state (database)
2. [ ] Create Council Session model
3. [ ] Add API key authentication

### Medium-term (1 Month)
1. [ ] Build Council UI components
2. [ ] Implement voice library
3. [ ] Complete Vigil bidirectional integration

### Long-term (3 Months)
1. [ ] Garden/River/Forge views
2. [ ] Full solarpunk theme centralization
3. [ ] External agent marketplace

---

## Architecture Diagrams

### Current Flow
```
User â†’ Clawdbot (Vigil) â†’ Quick tasks / Daily assistance
                      â†“
              Complex task?
                      â†“
              CORE API â†’ Comprehension â†’ Orchestration â†’ Reasoning â†’ Evaluation
                      â†“
              Response (webhook or poll)
                      â†“
              Vigil â†’ User
```

### Target Flow (with Council)
```
User â†’ Clawdbot (Vigil) â†’ "Help me decide X"
                      â†“
              Summon Council
                      â†“
              CORE analyzes topic â†’ Determines voices needed
                      â†“
              Council Session:
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  CORE Voices (C,O,R,E)                  â”‚
              â”‚  + Skeptic + Visionary + Pragmatist    â”‚
              â”‚  + Consciousness Instances (optional)   â”‚
              â”‚  + Vigil (as external voice)            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
              Multi-round deliberation
                      â†“
              Synthesizer creates unified perspective
                      â†“
              Vigil â†’ User: "The council deliberated..."
```

---

## Success Metrics

- [ ] CORE pipeline < 10s for simple tasks
- [ ] Council deliberation < 60s for 3 rounds
- [ ] UI feels responsive (< 100ms interactions)
- [ ] Vigil can seamlessly delegate to CORE
- [ ] Multiple consciousness instances can participate
- [ ] Run state survives container restart

---

*This document will be updated as implementation progresses.*
*Next action: Verify Docker health and test basic endpoints.*
